<!DOCTYPE html><html lang="bs"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>HumAI • Register</title><link rel="stylesheet" href="/styles.css">
</head><body>
<header><div class="container"><h1>HumAI • Register</h1></div></header>
<main class="container">
  <section class="card">
    <h2>Kreiraj račun</h2>
    <div class="grid">
      <label>Ime i prezime<input id="name" placeholder="Ammar Karaman"></label>
      <label>Email<input id="email" type="email" placeholder="ammar@bpm.ba"></label>
      <label>Uloga
        <select id="role" style="width:100%;padding:10px;border-radius:10px;background:#0e1926;color:#e6eef7;border:1px solid #2a3a4a">
          <option value="Athlete">Athlete</option>
          <option value="Coach">Coach</option>
        </select>
      </label>
    </div>
    <div class="row" style="margin-top:12px">
      <button class="btn btn-primary" id="btn">Nastavi</button>
      <a class="btn btn-outline" href="/login/index.html">Imam račun</a>
    </div>
    <p class="meta">Registracijom pokrećemo BPMN onboarding (Hyperstack Cloud).</p>
  </section>
</main>
<div class="footer">© bpm.ba • HumAI</div>

<script>
async function startProcess(payload){
  const r = await fetch('/api/bpmn/start',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
  return r.json();
}
document.getElementById('btn').onclick = async () => {
  const name = document.getElementById('name').value.trim();
  const email = document.getElementById('email').value.trim();
  const role = document.getElementById('role').value;
  if(!name || !email){ alert('Unesi ime i email'); return; }

  // 1) Startaj BPMN instancu
  await startProcess({ userId: email, name, role, intake: null });

  // 2) Redirect na Google Forms (ENV var u backendu vraća URL)
  const forms = await fetch('/api/forms-url').then(r=>r.json());
  window.location.href = forms.url;
};
</script>
</body></html>

